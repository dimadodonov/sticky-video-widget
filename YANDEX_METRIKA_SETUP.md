# Настройка интеграции с Яндекс.Метрикой

## Описание

В плагин Sticky Video Widget добавлена интеграция с Яндекс.Метрикой для отслеживания следующих событий:

- **Открытие виджета** - когда пользователь кликает на виджет и разворачивает видео
- **Клик по кнопке** - когда пользователь кликает на кнопку в развернутом виджете

## Настройка

### 1. Установка Яндекс.Метрики

Убедитесь, что на вашем сайте установлен код Яндекс.Метрики. Обычно он добавляется в `<head>` секцию сайта.

### 2. Настройка в админке WordPress

1. Перейдите в **Настройки → Sticky Video Widget**
2. В секции **"Настройки Яндекс.Метрики"** заполните:
   - **Идентификатор Яндекс.Метрики (открытие)** - например: `widget_open` или `video_widget_opened`
   - **Идентификатор Яндекс.Метрики (клик по кнопке)** - например: `button_click` или `widget_button_clicked`

### 3. Создание целей в Яндекс.Метрике

1. Войдите в интерфейс Яндекс.Метрики
2. Выберите ваш счетчик
3. Перейдите в **Настройки → Цели**
4. Создайте новую цель:
   - **Тип**: JavaScript-событие
   - **Идентификатор**: укажите тот же идентификатор, что и в настройках плагина
   - **Название**: например, "Открытие видео-виджета" или "Клик по кнопке виджета"

## Примеры идентификаторов событий

### Для открытия виджета:

- `widget_open`
- `video_widget_opened`
- `sticky_video_expand`
- `widget_interaction`

### Для клика по кнопке:

- `button_click`
- `widget_button_clicked`
- `cta_button_click`
- `conversion_button`

## Техническая информация

### Автоматическое определение ID счетчика

Плагин автоматически определяет ID счетчика Яндекс.Метрики и отправляет события. Если автоматическое определение не работает, будет использован fallback-метод.

### Проверка работы

1. Откройте ваш сайт
2. Откройте инструменты разработчика браузера (F12)
3. Перейдите на вкладку **Console**
4. Взаимодействуйте с виджетом (откройте его и кликните по кнопке)
5. В консоли должны появиться сообщения типа:
   ```
   Yandex Metrika event sent: widget_open Counter ID: XXXXXXXXX
   Yandex Metrika event sent: button_click Counter ID: XXXXXXXXX
   ```

### Отладка

Если события не отправляются, проверьте:

1. Установлена ли Яндекс.Метрика на сайте
2. Правильно ли указаны идентификаторы событий в настройках плагина
3. Созданы ли соответствующие цели в интерфейсе Яндекс.Метрики

## Поддержка

При возникновении проблем обратитесь к разработчику плагина через https://mitroliti.com
